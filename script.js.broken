// Movie database with vibes and details
const movieDatabase = {
    happy: [
        { title: "Amélie", year: 2001, director: "Jean-Pierre Jeunet", poster: "https://image.tmdb.org/t/p/w300/nSxDa3M9aMvGVLoItzWTepQ5h5d.jpg", description: "A whimsical romance about a shy waitress who decides to change the lives of those around her." },
        { title: "La La Land", year: 2016, director: "Damien Chazelle", poster: "https://image.tmdb.org/t/p/w300/uDO8zWDhfWwoFdKS4fzkUJt0Rf0.jpg", description: "A jazz pianist and an aspiring actress fall in love while pursuing their dreams in Los Angeles." },
        { title: "The Grand Budapest Hotel", year: 2014, director: "Wes Anderson", poster: "https://image.tmdb.org/t/p/w300/eWdyYQreja6JGCzqHWXpWHDrrPo.jpg", description: "A legendary concierge and his protégé become embroiled in a theft and framing." },
        { title: "Everything Everywhere All at Once", year: 2022, director: "Daniels", poster: "https://image.tmdb.org/t/p/w300/w3LxiVYdWWRvEVdn5RYq6jIqkb1.jpg", description: "A Chinese immigrant is swept into a wild adventure through the multiverse." },
        { title: "Booksmart", year: 2019, director: "Olivia Wilde", poster: "https://image.tmdb.org/t/p/w300/micaVOa1UZsdzs4fKGA67ZMGOzc.jpg", description: "Two academic overachievers realize they should have worked less and played more on their last day of high school." },
        { title: "Legally Blonde", year: 2001, director: "Robert Luketic", poster: "https://image.tmdb.org/t/p/w300/4ABNnmkVpzplrEVQWt1piITT0Ey.jpg", description: "A sorority girl follows her ex to Harvard Law and discovers her own potential." },
        { title: "Toy Story", year: 1995, director: "John Lasseter", poster: "https://image.tmdb.org/t/p/w300/uXDfjJbdP4ijW5hWSBrPrlKpxab.jpg", description: "Toys come to life when humans aren't around in this groundbreaking animated adventure." },
        { title: "The Truman Show", year: 1998, director: "Peter Weir", poster: "https://image.tmdb.org/t/p/w300/vuza0WqY239yBXOadKlGwJsZJFE.jpg", description: "A man discovers his entire life is a reality TV show in this uplifting and thought-provoking film." }
    ],
    sad: [
        { title: "Eternal Sunshine of the Spotless Mind", year: 2004, director: "Michel Gondry", poster: "https://image.tmdb.org/t/p/w300/5MwkWH9tYHv3mV9OdYTMR5qreIz.jpg", description: "A couple undergoes a procedure to erase each other from their memories." },
        { title: "Manchester by the Sea", year: 2016, director: "Kenneth Lonergan", poster: "https://image.tmdb.org/t/p/w300/e8daDzP0vFOnGyKmve95Yv0D0io.jpg", description: "A man confronts his tragic past while caring for his teenage nephew." },
        { title: "Her", year: 2013, director: "Spike Jonze", poster: "https://image.tmdb.org/t/p/w300/lEIaL12hSkqqe83kgADkbUqEnvk.jpg", description: "A lonely writer develops an unlikely relationship with an AI operating system." },
        { title: "The Pianist", year: 2002, director: "Roman Polanski", poster: "https://image.tmdb.org/t/p/w300/2hFvxCCWrTmCYwfy7yum0GKRi3Y.jpg", description: "A Polish Jewish musician struggles to survive the destruction of the Warsaw ghetto." },
        { title: "Schindler's List", year: 1993, director: "Steven Spielberg", poster: "https://image.tmdb.org/t/p/w300/sF1U4EUQS8YHUYjNl3pMGNIQyr0.jpg", description: "A businessman saves the lives of more than a thousand Jewish refugees during the Holocaust." },
        { title: "The Green Mile", year: 1999, director: "Frank Darabont", poster: "https://image.tmdb.org/t/p/w300/velWPhVMQeQKcxggNEU8YmIo52R.jpg", description: "Death row guards encounter a prisoner with a miraculous gift." },
        { title: "Life Is Beautiful", year: 1997, director: "Roberto Benigni", poster: "https://image.tmdb.org/t/p/w300/74hLDKjD5aGYOotO6esUVaeISa2.jpg", description: "A father uses humor and imagination to shield his son from the horrors of a concentration camp." }
    ],
    anxious: [
        { title: "Whiplash", year: 2014, director: "Damien Chazelle", poster: "https://image.tmdb.org/t/p/w300/7fn624j5lj3xTme2SgiLCeuedmO.jpg", description: "A young drummer struggles under an abusive instructor's relentless pursuit of perfection." },
        { title: "Nightcrawler", year: 2014, director: "Dan Gilroy", poster: "https://image.tmdb.org/t/p/w300/j9HrX8f7GbZQm1BrBiR40uFQZSb.jpg", description: "A man discovers the violent nocturnal world of freelance crime journalism." },
        { title: "Mother!", year: 2017, director: "Darren Aronofsky", poster: "https://image.tmdb.org/t/p/w300/qmi2dsuoyzZdJ0WFZYQazbX8ILj.jpg", description: "A couple's tranquil existence is disrupted by uninvited guests." },
        { title: "The Lighthouse", year: 2019, director: "Robert Eggers", poster: "https://image.tmdb.org/t/p/w300/3nk9UoepYmv1G9oP18q6JJCeYwN.jpg", description: "Two lighthouse keepers descend into madness on a remote island." },
        { title: "Hereditary", year: 2018, director: "Ari Aster", poster: "https://image.tmdb.org/t/p/w300/lHV8HHlhwNup2VbpiACtlKzaGIQ.jpg", description: "A family is haunted by a mysterious presence after their grandmother dies." },
        { title: "No Country for Old Men", year: 2007, director: "Coen Brothers", poster: "https://image.tmdb.org/t/p/w300/bj1v6YKF8yHqA489VFfnQvOJpnc.jpg", description: "A hunter finds a drug deal gone wrong and is pursued by a relentless killer." },
        { title: "Gone Girl", year: 2014, director: "David Fincher", poster: "https://image.tmdb.org/t/p/w300/lv5xShBIDPe7m4ufdlV0IAc7Avk.jpg", description: "A husband becomes the prime suspect when his wife disappears on their anniversary." },
        { title: "The Silence of the Lambs", year: 1991, director: "Jonathan Demme", poster: "https://image.tmdb.org/t/p/w300/rplLJ2hPcOQmkFhTqUte0MkEaO2.jpg", description: "An FBI trainee seeks help from an imprisoned cannibal to catch another serial killer." },
        { title: "Parasite", year: 2019, director: "Bong Joon-ho", poster: "https://image.tmdb.org/t/p/w300/7IiTTgloJzvGI1TAYymCfbfl3vT.jpg", description: "A poor family schemes to infiltrate a wealthy household with unpredictable consequences." }
    ],
    melancholic: [
        { title: "Moonlight", year: 2016, director: "Barry Jenkins", poster: "https://image.tmdb.org/t/p/w300/qhUIOTSi3kr4290tKrVyeriyvrv.jpg", description: "A young Black man grapples with identity and sexuality across three chapters of his life." },
        { title: "Blade Runner 2049", year: 2017, director: "Denis Villeneuve", poster: "https://image.tmdb.org/t/p/w300/gajva2L0rPYkEWjzgFlBXCAVBE5.jpg", description: "A replicant blade runner uncovers a secret that could plunge society into chaos." },
        { title: "Arrival", year: 2016, director: "Denis Villeneuve", poster: "https://image.tmdb.org/t/p/w300/x2FJsf1ElAgr63Y3PNPtJrcmpoe.jpg", description: "A linguist is recruited to communicate with extraterrestrial visitors." }
    ],
    energetic: [
        { title: "Mad Max: Fury Road", year: 2015, director: "George Miller", poster: "https://image.tmdb.org/t/p/w300/hA2ple9q4qnwxp3hKVNhroipsir.jpg", description: "A post-apocalyptic chase across the desert in pursuit of freedom." },
        { title: "Baby Driver", year: 2017, director: "Edgar Wright", poster: "https://image.tmdb.org/t/p/w300/rmnQ9jKW72bHu8uKlMjPIb2VLMI.jpg", description: "A talented getaway driver tries to break free from a life of crime." },
        { title: "Scott Pilgrim vs. the World", year: 2010, director: "Edgar Wright", poster: "https://image.tmdb.org/t/p/w300/g5IoYeudx9XBEfwNL0fHvSckLBz.jpg", description: "A bassist must defeat his girlfriend's seven evil exes." },
        { title: "The Social Network", year: 2010, director: "David Fincher", poster: "https://image.tmdb.org/t/p/w300/n0ybibhJtQ5icDqTp8eRytcIHJx.jpg", description: "The founding of Facebook and the lawsuits that followed." },
        { title: "Spider-Man: Into the Spider-Verse", year: 2018, director: "Bob Persichetti", poster: "https://image.tmdb.org/t/p/w300/iiZZdoQBEYBv6id8su7ImL0oCbD.jpg", description: "A Brooklyn teen becomes Spider-Man and meets other Spider-People from parallel universes." },
        { title: "John Wick", year: 2014, director: "Chad Stahelski", poster: "https://image.tmdb.org/t/p/w300/fZPSd91yGE9fCcCe6OoQr6E3Bev.jpg", description: "A retired assassin seeks vengeance for the killing of his dog." },
        { title: "Mission: Impossible - Fallout", year: 2018, director: "Christopher McQuarrie", poster: "https://image.tmdb.org/t/p/w300/AkJQpZp9WoNdj7pLYSj1L0RcMMN.jpg", description: "Ethan Hunt faces his toughest mission yet with global stakes." },
        { title: "Kill Bill: Vol. 1", year: 2003, director: "Quentin Tarantino", poster: "https://image.tmdb.org/t/p/w300/v7TaX8kXMXs5yFFGR41guUDNcnB.jpg", description: "A former assassin seeks revenge on her former colleagues." },
        { title: "Top Gun: Maverick", year: 2022, director: "Joseph Kosinski", poster: "https://image.tmdb.org/t/p/w300/62HCnUTziyWcpDaBO2i1DX17ljH.jpg", description: "A test pilot trains a new generation of aviators for a dangerous mission." },
        { title: "Hot Fuzz", year: 2007, director: "Edgar Wright", poster: "https://image.tmdb.org/t/p/w300/zPib4ukTSdXvHP9pxGkFCe34f3y.jpg", description: "A top London cop is transferred to a quiet village with a dark secret." },
        { title: "The Matrix", year: 1999, director: "Wachowskis", poster: "https://image.tmdb.org/t/p/w300/f89U3ADr1oiB1s9GkdPOEpXUk5H.jpg", description: "A hacker discovers reality is a simulation and joins a rebellion against machines." },
        { title: "Inception", year: 2010, director: "Christopher Nolan", poster: "https://image.tmdb.org/t/p/w300/ljsZTbVsrQSqZgWeep2B1QiDKuh.jpg", description: "A thief who steals secrets through dream infiltration takes on a dangerous final job." },
        { title: "Die Hard", year: 1988, director: "John McTiernan", poster: "https://image.tmdb.org/t/p/w300/yFihWxQcmqcaBR31QM6Y8gT6aYV.jpg", description: "A cop battles terrorists who have taken over a Los Angeles skyscraper." },
        { title: "Raiders of the Lost Ark", year: 1981, director: "Steven Spielberg", poster: "https://image.tmdb.org/t/p/w300/ceG9VzoRAVGwivFU403Wc3AHRys.jpg", description: "An archaeologist races to find the Ark of the Covenant before the Nazis." }
    ],
    nostalgic: [
        { title: "Call Me by Your Name", year: 2017, director: "Luca Guadagnino", poster: "https://image.tmdb.org/t/p/w300/mZ4gBdfkhP9tvLH1DO4m4HYtiyi.jpg", description: "A summer romance unfolds between a teenage boy and a visiting scholar in 1980s Italy." },
        { title: "Good Will Hunting", year: 1997, director: "Gus Van Sant", poster: "https://image.tmdb.org/t/p/w300/bABCBKYBK7A5G1x0FzoeoNfuj2.jpg", description: "A janitor at MIT is discovered to be a mathematical genius." },
        { title: "Cinema Paradiso", year: 1988, director: "Giuseppe Tornatore", poster: "https://image.tmdb.org/t/p/w300/gCI2AeMV4IHSewhJkzsur5MEp6R.jpg", description: "A filmmaker recalls his childhood friendship with a movie theater projectionist in Sicily." }
    ],
    contemplative: [
        { title: "2001: A Space Odyssey", year: 1968, director: "Stanley Kubrick", poster: "https://image.tmdb.org/t/p/w300/ve72VxNqjGM69Uky4WTo2bK6rfq.jpg", description: "A voyage to Jupiter turns into a philosophical journey through space and time." },
        { title: "Interstellar", year: 2014, director: "Christopher Nolan", poster: "https://image.tmdb.org/t/p/w300/gEU2QniE6E77NI6lCU6MxlNBvIx.jpg", description: "A team of astronauts travels through a wormhole in search of a new home." },
        { title: "Blade Runner", year: 1982, director: "Ridley Scott", poster: "https://image.tmdb.org/t/p/w300/63N9uy8nd9j7Eog2axPQ8lbr3Wj.jpg", description: "A detective hunts rogue replicants while questioning what it means to be human." },
        { title: "Her", year: 2013, director: "Spike Jonze", poster: "https://image.tmdb.org/t/p/w300/lEIaL12hSkqqe83kgADkbUqEnvk.jpg", description: "A lonely man develops a relationship with an AI operating system in near-future Los Angeles." }
    ],
    weird: [
        { title: "Sorry to Bother You", year: 2018, director: "Boots Riley", poster: "https://image.tmdb.org/t/p/w300/peTl1V04E9ppvhgvNmSX0r2ALqO.jpg", description: "A telemarketer discovers a magical key to success with bizarre consequences." }
    ],
    cozy: [
        { title: "Kiki's Delivery Service", year: 1989, director: "Hayao Miyazaki", poster: "https://image.tmdb.org/t/p/w300/7nO5DUMnGUuXrA4r2h6ESOKQRrx.jpg", description: "A young witch starts a delivery service in a seaside town." },
        { title: "My Neighbor Totoro", year: 1988, director: "Hayao Miyazaki", poster: "https://image.tmdb.org/t/p/w300/rtGDOeG9LzoerkDGZF9dnVeLppL.jpg", description: "Two girls discover magical forest spirits while their mother is in the hospital." },
        { title: "When Harry Met Sally", year: 1989, director: "Rob Reiner", poster: "https://image.tmdb.org/t/p/w300/3wkbKeowUp1Zpkw1KkBqMWbt0P9.jpg", description: "Two friends question whether men and women can ever just be friends." },
        { title: "Midnight in Paris", year: 2011, director: "Woody Allen", poster: "https://image.tmdb.org/t/p/w300/4wBG5kbfagTQclETblPRRGihk0I.jpg", description: "A writer travels back to 1920s Paris every night at midnight." },
        { title: "Amélie", year: 2001, director: "Jean-Pierre Jeunet", poster: "https://image.tmdb.org/t/p/w300/nSxDa3M9aMvGVLoItzWTepQ5h5d.jpg", description: "A whimsical waitress secretly improves the lives of those around her." },
        { title: "Groundhog Day", year: 1993, director: "Harold Ramis", poster: "https://image.tmdb.org/t/p/w300/gCgt1WARPZaXnq523ySQEUKinCs.jpg", description: "A weatherman relives the same day over and over." },
        { title: "Spirited Away", year: 2001, director: "Hayao Miyazaki", poster: "https://image.tmdb.org/t/p/w300/39wmItIWsg5sZMyRUHLkWBcuVCM.jpg", description: "A girl must work in a magical bathhouse to free her parents from a curse." }
    ],
    sad: [

    ],
    anxious: [

    ],
    melancholic: [

    ],
    energetic: [

    ],
    nostalgic: [

    ],
    contemplative: [

    ],
    weird: [

    ],
    cozy: ['cozy', 'warm', 'comfortable', 'peaceful', 'calm', 'relaxed', 'chill', 'mellow', 'content'],
};

const emotionSuggestions = [
    { text: 'happy', label: 'happy' },
    { text: 'melancholic', label: 'melancholic' },
    { text: 'anxious', label: 'anxious' },
    { text: 'nostalgic', label: 'nostalgic' },
    { text: 'cozy', label: 'cozy' },
    { text: 'weird', label: 'weird' },
    { text: 'energetic', label: 'energetic' },
    { text: 'contemplative', label: 'contemplative' },
    { text: 'sad', label: 'sad' },
];

let currentEmotions = [];
let usedMovies = [];

// Get elements
const emotionInput = document.getElementById('emotion-input');
const findBtn = document.getElementById('find-btn');
const regenerateBtn = document.getElementById('regenerate-btn');
const results = document.getElementById('results');
const moviesGrid = document.getElementById('movies-grid');
const loading = document.getElementById('loading');
const modal = document.getElementById('movie-modal');
const modalClose = document.getElementById('modal-close');
const suggestionChips = document.getElementById('suggestion-chips');

// Create suggestion chips
emotionSuggestions.forEach(suggestion => {
    const chip = document.createElement('button');
    chip.className = 'chip';
    chip.textContent = suggestion.text;
    chip.addEventListener('click', () => {
        emotionInput.value = suggestion.text;
        findFilms();
    });
    suggestionChips.appendChild(chip);
});

// Detect emotions from input (supports multiple)
function detectEmotions(input) {
    const lowerInput = input.toLowerCase();
    const detectedEmotions = [];

    // Check for each emotion
    for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
        if (keywords.some(keyword => lowerInput.includes(keyword))) {
            detectedEmotions.push(emotion);
        }
    }

    // If no emotions detected, pick a random one
    if (detectedEmotions.length === 0) {
        const emotions = Object.keys(movieDatabase);
        detectedEmotions.push(emotions[Math.floor(Math.random() * emotions.length)]);
    }

    return detectedEmotions;
}

// Get random movies for one or more emotions
function getRandomMovies(emotions, count = 8) {
    let allMovies = [];

    // If single emotion, use movies from that category
    if (emotions.length === 1) {
        allMovies = [...movieDatabase[emotions[0]]];
    } else {
        // For multiple emotions, combine movies from all categories
        emotions.forEach(emotion => {
            allMovies = allMovies.concat([...movieDatabase[emotion]]);
        });

        // Shuffle the combined array
        allMovies.sort(() => Math.random() - 0.5);
    }

    const selected = [];

    // Filter out recently used movies and movies without posters
    const available = allMovies.filter(movie =>
        !usedMovies.some(used => used.title === movie.title) &&
        movie.poster && movie.poster.trim() !== ''
    );

    // If we've used too many, reset
    if (available.length < count) {
        usedMovies = [];
        return getRandomMovies(emotions, count);
    }
    
    // Randomly select movies
    for (let i = 0; i < count && i < available.length; i++) {
        const randomIndex = Math.floor(Math.random() * available.length);
        selected.push(available[randomIndex]);
        available.splice(randomIndex, 1);
    }

    // Track used movies
    usedMovies.push(...selected);
    if (usedMovies.length > 20) {
        usedMovies = usedMovies.slice(-20);
    }

    return selected;
}

// Show movie details in modal
function showMovieDetails(movie) {
    const modalPoster = document.getElementById('modal-poster');
    
    // Clear previous content
    modalPoster.innerHTML = '';
    modalPoster.style.backgroundImage = '';
    modalPoster.style.backgroundColor = stringToColor(movie.title);

    // If poster URL exists, try to load it
    if (movie.poster && movie.poster.trim() !== '') {
        // Create an image to test if it loads
        const img = new Image();
        img.onload = function() {
            // Image loaded successfully, use it as background
            modalPoster.style.backgroundImage = `url('${movie.poster}')`;
            modalPoster.style.backgroundSize = 'cover';
            modalPoster.style.backgroundPosition = 'center';
        };
        img.onerror = function() {
            // Image failed to load, use fallback with title
            const title = document.createElement('div');
            title.className = 'modal-poster-title';
            title.textContent = movie.title;
            modalPoster.appendChild(title);
        };
        img.src = movie.poster;
    } else {
        // No poster URL, use fallback with title
        const title = document.createElement('div');
        title.className = 'modal-poster-title';
        title.textContent = movie.title;
        modalPoster.appendChild(title);
    }

    document.getElementById('modal-title').textContent = movie.title;
    document.getElementById('modal-year').textContent = movie.year;
    document.getElementById('modal-director').textContent = movie.director;
    document.getElementById('modal-description').textContent = movie.description;
    modal.classList.add('active');
}

// Close modal
function closeModal() {
    modal.classList.remove('active');
}

modalClose.addEventListener('click', closeModal);
modal.addEventListener('click', (e) => {
    if (e.target === modal) {
        closeModal();
    }
});

// Generate consistent color from string
function stringToColor(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
        hash = str.charCodeAt(i) + ((hash << 5) - hash);
    }
    const hue = Math.abs(hash % 360);
    return `hsl(${hue}, 40%, 25%)`;
}

// Display movies with validation
async function displayMovies(movies, targetCount = 4) {
    moviesGrid.innerHTML = '';
    results.classList.remove('hidden');
    loading.classList.remove('hidden');
    moviesGrid.classList.add('hidden');
    regenerateBtn.style.display = 'none';
    
    let validMovies = [];
    let attemptedMovies = new Set();
    let movieIndex = 0;
    const maxAttempts = 20; // Cap on total movies to try
    let totalAttempts = 0;

    // Function to validate a single poster
    function validatePoster(movie) {
        return new Promise((resolve) => {
            if (!movie.poster || movie.poster.trim() === '') {
                resolve(false);
                return;
            }

            const img = new Image();
            img.onload = function() {
                resolve(true);
            };
            img.onerror = function() {
                console.log(`Failed to load poster for: ${movie.title}`);
                resolve(false);
            };
            img.src = movie.poster;
        });
    }

    // Function to add a movie card to the grid
    function addMovieCard(movie) {
        const movieCard = document.createElement('div');
        movieCard.className = 'movie-card';
        movieCard.addEventListener('click', () => showMovieDetails(movie));

        const poster = document.createElement('div');
        poster.className = 'movie-poster';
        poster.style.backgroundImage = `url('${movie.poster}')`;
        poster.style.backgroundSize = 'cover';
        poster.style.backgroundPosition = 'center';

        movieCard.appendChild(poster);
        moviesGrid.appendChild(movieCard);
    }

    // Try movies until we have enough valid ones
    while (validMovies.length < targetCount && movieIndex < movies.length && totalAttempts < maxAttempts) {
        const movie = movies[movieIndex];
        movieIndex++;
        totalAttempts++;

        // Skip if already attempted
        if (attemptedMovies.has(movie.title)) {
            continue;
        }
        attemptedMovies.add(movie.title);

        // Validate poster
        const isValid = await validatePoster(movie);
        if (isValid) {
            validMovies.push(movie);
            addMovieCard(movie);
        }
    }

    // If we still don't have enough, try to get more movies
    if (validMovies.length < targetCount && totalAttempts < maxAttempts) {
        console.log(`Only found ${validMovies.length} valid posters, trying to get more...`);
        const moreMovies = getRandomMovies(currentEmotions, targetCount * 2);
        
        // Filter out movies we've already tried
        const newMovies = moreMovies.filter(m => !attemptedMovies.has(m.title));
        
        // Try the new movies
        for (const movie of newMovies) {
            if (validMovies.length >= targetCount || totalAttempts >= maxAttempts) {
                break;
            }
            
            attemptedMovies.add(movie.title);
            totalAttempts++;
            
            const isValid = await validatePoster(movie);
            if (isValid) {
                validMovies.push(movie);
                addMovieCard(movie);
            }
        }
    }

    console.log(`Displayed ${validMovies.length} movies after ${totalAttempts} attempts`);
    
    // Hide loading, show results
    loading.classList.add('hidden');
    moviesGrid.classList.remove('hidden');
    regenerateBtn.style.display = 'block';
}

// Find films based on emotion(s)
async function findFilms() {
    const input = emotionInput.value.trim();

    if (!input) {
        emotionInput.focus();
        return;
    }

    currentEmotions = detectEmotions(input);
    const movies = getRandomMovies(currentEmotions, 8); // Get more movies initially
    await displayMovies(movies, 4);
}

// Regenerate recommendations
async function regenerate() {
    if (!currentEmotions || currentEmotions.length === 0) return;

    // Trigger fade out
    moviesGrid.style.opacity = '0';

    setTimeout(async () => {
        const movies = getRandomMovies(currentEmotions, 8); // Get more movies initially
        await displayMovies(movies, 4);
        moviesGrid.style.opacity = '1';
    }, 300);
}

// Event listeners
findBtn.addEventListener('click', findFilms);
regenerateBtn.addEventListener('click', regenerate);

emotionInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        findFilms();
    }
});

// Close modal with Escape key
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && modal.classList.contains('active')) {
        closeModal();
    }
});
